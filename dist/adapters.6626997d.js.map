{"mappings":"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","sources":["<anon>","src/adapters/index.ts","src/shared/snowplow/index.ts","src/shared/snowplow/types.ts","src/shared/types.ts","src/shared/snowplow/tracker.ts","node_modules/@parcel/runtime-js/lib/runtime-102929f45ac82b3c.js","node_modules/@parcel/runtime-js/lib/runtime-e0d297dcc3d49658.js","src/shared/snowplow/extensions/index.ts","src/shared/snowplow/extensions/segments.ts","src/shared/segment-builder/index.ts","src/shared/segment-builder/builder.ts","src/shared/segment-builder/segments/liquidm.ts","src/shared/segment-builder/segments/nexxen.ts","src/shared/utils/create-image-pixel.ts","src/shared/segment-builder/segments/dstillery.ts","src/shared/segment-builder/types.ts","src/shared/snowplow/extensions/google-ads.ts","src/shared/snowplow/extensions/bing-ads.ts","src/shared/snowplow/extensions/deduplicator.ts","src/shared/snowplow/extensions/ensure-basket-items-order-id.ts","src/shared/snowplow/extensions/register-third-party-tags.ts","node_modules/@parcel/runtime-js/lib/runtime-faef101529aad474.js","node_modules/@parcel/runtime-js/lib/runtime-b1cfc8f3edef4dd6.js"],"sourcesContent":["(function () {\n\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\n\n      var $parcel$global =\n        typeof globalThis !== 'undefined'\n          ? globalThis\n          : typeof self !== 'undefined'\n          ? self\n          : typeof window !== 'undefined'\n          ? window\n          : typeof global !== 'undefined'\n          ? global\n          : {};\n  var parcelRequire = $parcel$global[\"parcelRequire07df\"];\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"9tnsc\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $41a6c7ecc8ff7cf9$export$2e2bcd8739ae039; });\n\nvar $lwczO = parcelRequire(\"lwczO\");\nparcelRequire(\"gaoAP\");\nvar $dfzZn = parcelRequire(\"dfzZn\");\n\nvar $7FWw7 = parcelRequire(\"7FWw7\");\nvar $iN4ie = parcelRequire(\"iN4ie\");\nvar $9nXWu = parcelRequire(\"9nXWu\");\n\nvar $cmhQG = parcelRequire(\"cmhQG\");\n\nvar $bhLWo = parcelRequire(\"bhLWo\");\n\n\n\n\n\nconst $41a6c7ecc8ff7cf9$var$loadAdapters = async (context)=>{\n    var _context_plugin;\n    const plugins = (context === null || context === void 0 ? void 0 : (_context_plugin = context.plugin) === null || _context_plugin === void 0 ? void 0 : _context_plugin.split(\",\")) || [];\n    const snowplow = await (0, $dfzZn.default)(context);\n    // Apply extensions to the tracker\n    const tracker = (0, $7FWw7.applyExtensions)(snowplow, [\n        (0, $iN4ie.default),\n        (0, $cmhQG.default),\n        (0, $bhLWo.default),\n        (0, $9nXWu.default),\n        /** Dynamically add Google Ads plugin/extension */ plugins.includes(\"googleAds\") && await Promise.resolve((parcelRequire(\"7FWw7\"))).then(({ withGoogleAdsExtension: withGoogleAdsExtension })=>withGoogleAdsExtension),\n        /** Dynamically add Bing Ads plugin/extension */ plugins.includes(\"bingAds\") && await Promise.resolve((parcelRequire(\"7FWw7\"))).then(({ withBingAdsExtension: withBingAdsExtension })=>withBingAdsExtension)\n    ]);\n    window.trackTrans = tracker.ecommerce.trackTransaction;\n    window.trackSignUp = tracker.trackSignup;\n    window.addToCart = tracker.ecommerce.trackAddToCart;\n    window.removeFromCart = tracker.ecommerce.trackRemoveFromCart;\n    switch(context.event){\n        case \"transaction\":\n            (parcelRequire(\"gjtns\")).then(({ default: load })=>load(tracker));\n            break;\n        case \"impression\":\n            (parcelRequire(\"jV2KE\")).then(({ default: load })=>load(tracker));\n            break;\n        case \"signup\":\n            tracker.trackSignup(context);\n            break;\n        default:\n            if (!context.environment) {\n                (0, $lwczO.default).warn(\"No event/environment specified, Only pageview is active\");\n                return;\n            }\n            (parcelRequire(\"gjtns\")).then(({ default: load })=>load(tracker));\n            (0, $lwczO.default).warn(`No event specified, Loading ${context.environment}`);\n    }\n};\nvar $41a6c7ecc8ff7cf9$export$2e2bcd8739ae039 = $41a6c7ecc8ff7cf9$var$loadAdapters;\n\n});\nparcelRegister(\"gaoAP\", function(module, exports) {\n\n$parcel$export(module.exports, \"createSnowplowTracker\", function () { return (parcelRequire(\"dfzZn\")).default; });\nparcelRequire(\"l2W8L\");\n\nvar $dfzZn = parcelRequire(\"dfzZn\");\n\n});\nparcelRegister(\"l2W8L\", function(module, exports) {\n\nvar $hkXx1 = parcelRequire(\"hkXx1\");\n\n});\nparcelRegister(\"hkXx1\", function(module, exports) {\n\n});\n\n\nparcelRegister(\"dfzZn\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $71b2d7d1db8aa308$export$2e2bcd8739ae039; });\n\nvar $lwczO = parcelRequire(\"lwczO\");\n\n\nconst $71b2d7d1db8aa308$var$createSnowplowTracker = async (input)=>{\n    const { appId: appId, collector: collector, event: event } = input;\n    (0, $lwczO.default).info(`Creating Snowplow tracker for version ${input.version}`);\n    const isLegacyTracker = input.version === \"1\";\n    const createSnowplowV1Tracker = async ()=>{\n        return await (parcelRequire(\"exMKC\")).then(async ({ default: createSnowplowV1Tracker })=>await createSnowplowV1Tracker(input));\n    };\n    const createSnowplowV2Tracker = async ()=>{\n        return await (parcelRequire(\"3HWzl\")).then(async ({ default: createSnowplowV2Tracker })=>await createSnowplowV2Tracker(input));\n    };\n    const tracker = isLegacyTracker ? await createSnowplowV1Tracker() : await createSnowplowV2Tracker();\n    tracker.initialize({\n        appId: appId,\n        collector: collector,\n        event: event\n    });\n    tracker.record(input);\n    return tracker;\n};\nvar $71b2d7d1db8aa308$export$2e2bcd8739ae039 = $71b2d7d1db8aa308$var$createSnowplowTracker;\n\n});\nparcelRegister(\"exMKC\", function(module, exports) {\n\n\nmodule.exports = (parcelRequire(\"aiXW3\"))((parcelRequire(\"7SZEv\")).resolve(\"32qsa\")).then(()=>parcelRequire(\"a7EfY\"));\n\n});\n\nparcelRegister(\"3HWzl\", function(module, exports) {\n\n\nmodule.exports = (parcelRequire(\"aiXW3\"))((parcelRequire(\"7SZEv\")).resolve(\"dqqna\")).then(()=>parcelRequire(\"dFSGc\"));\n\n});\n\n\n\nparcelRegister(\"7FWw7\", function(module, exports) {\n\n$parcel$export(module.exports, \"applyExtensions\", function () { return $3c9a89d8c1dfcb00$export$3ad3a750c394cfe6; });\n$parcel$export(module.exports, \"withSnowplowSegmentsExtension\", function () { return (parcelRequire(\"9nXWu\")).default; });\n$parcel$export(module.exports, \"withGoogleAdsExtension\", function () { return (parcelRequire(\"2JcTW\")).default; });\n$parcel$export(module.exports, \"withBingAdsExtension\", function () { return (parcelRequire(\"iKE1G\")).default; });\n$parcel$export(module.exports, \"withDeduplicationExtension\", function () { return (parcelRequire(\"iN4ie\")).default; });\n\nvar $9nXWu = parcelRequire(\"9nXWu\");\n\nvar $2JcTW = parcelRequire(\"2JcTW\");\n\nvar $iKE1G = parcelRequire(\"iKE1G\");\n\nvar $iN4ie = parcelRequire(\"iN4ie\");\nconst $3c9a89d8c1dfcb00$export$3ad3a750c394cfe6 = (tracker, // Either load a function or undefined for dynamic loading\nextensions)=>{\n    return extensions.reduce((currentTracker, extension)=>extension ? extension(currentTracker) : currentTracker, tracker);\n};\n\n});\nparcelRegister(\"9nXWu\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $dee74d8dbb686cf7$export$2e2bcd8739ae039; });\nparcelRequire(\"i0MG4\");\nvar $gDuU6 = parcelRequire(\"gDuU6\");\nconst $dee74d8dbb686cf7$var$setupExtension = (context)=>{\n    const liquidm = context.segmentId || context.s1;\n    //* If s2.pv or s2.tr is not present, use context.s2 as default\n    //* mainly used for legacy purposes\n    const nexxen = {\n        pageVisitorBeaconId: context[\"s2.pv\"] || context[\"s2\"],\n        transactionBeaconId: context[\"s2.tr\"] || context[\"s2\"]\n    };\n    const dstillery = {\n        siteVisitorNC: context[\"s3.pv\"] || context[\"s3\"],\n        purchaseNC: context[\"s3.tr\"] || context[\"s3\"]\n    };\n    const segments = (0, $gDuU6.default)({\n        liquidm: //* Accept both segmentId and s1 for legacy purposes\n        liquidm,\n        nexxen: nexxen,\n        dstillery: dstillery\n    });\n    //* Expose cnnaSegments to the window object for custom integrations to use\n    window.cnnaSegments = segments;\n    liquidm && segments.liquidm.emit();\n    nexxen && segments.nexxen.emit();\n    dstillery && segments.dstillery.emit();\n    return segments;\n};\n/**\n * This extension will send transaction events to our partner segments when a transaction is tracked\n */ const $dee74d8dbb686cf7$var$withSnowplowSegmentsExtension = (snowplow)=>{\n    const segments = $dee74d8dbb686cf7$var$setupExtension(snowplow.context);\n    // Original trackTransaction method\n    const trackTransaction = snowplow.ecommerce.trackTransaction;\n    //* Override the trackTransaction method\n    snowplow.ecommerce.trackTransaction = (input)=>{\n        trackTransaction(input);\n        segments.nexxen.emitPurchase({\n            bprice: input.total,\n            cid: input.id\n        });\n        segments.dstillery.emitPurchase({\n            amount: input.total,\n            orderId: input.id\n        });\n    };\n    return snowplow;\n};\nvar $dee74d8dbb686cf7$export$2e2bcd8739ae039 = $dee74d8dbb686cf7$var$withSnowplowSegmentsExtension;\n\n});\nparcelRegister(\"i0MG4\", function(module, exports) {\n\n$parcel$export(module.exports, \"createSegments\", function () { return (parcelRequire(\"gDuU6\")).default; });\n\nvar $gDuU6 = parcelRequire(\"gDuU6\");\nparcelRequire(\"cdX3u\");\n\n});\nparcelRegister(\"gDuU6\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $641eec616192426d$export$2e2bcd8739ae039; });\n\nvar $kcTRk = parcelRequire(\"kcTRk\");\n\nvar $8MHlY = parcelRequire(\"8MHlY\");\n\nvar $brv19 = parcelRequire(\"brv19\");\nconst $641eec616192426d$var$createSegments = (input)=>{\n    const { liquidm: liquidm, nexxen: nexxen, dstillery: dstillery } = input;\n    return {\n        nexxen: (0, $8MHlY.default)(nexxen),\n        liquidm: (0, $kcTRk.default)(liquidm),\n        dstillery: (0, $brv19.default)(dstillery)\n    };\n};\nvar $641eec616192426d$export$2e2bcd8739ae039 = $641eec616192426d$var$createSegments;\n\n});\nparcelRegister(\"kcTRk\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $c72892d13a5cb6a6$export$2e2bcd8739ae039; });\n\nvar $lwczO = parcelRequire(\"lwczO\");\nconst $c72892d13a5cb6a6$var$liquidmSegmentBuilder = (segmentId)=>{\n    return {\n        emit: ()=>{\n            (0, $lwczO.default).info(\"Building s1 segment with segmentId: \", segmentId);\n            (function(c, d) {\n                var a = document.createElement(\"script\");\n                a.type = \"text/javascript\";\n                a.async = !0;\n                a.src = `https://tracking.lqm.io/odin/handle_sync.js?seg=${segmentId}&gdpr=` + (\"1\" === c ? \"1\" : \"0\") + \"&gdpr_consent=\" + (d ? encodeURIComponent(d) : \"\") + \"&cb=\" + new Date().getTime();\n                var b = document.getElementsByTagName(\"script\")[0];\n                b.parentNode.insertBefore(a, b);\n            })();\n        }\n    };\n};\nvar $c72892d13a5cb6a6$export$2e2bcd8739ae039 = $c72892d13a5cb6a6$var$liquidmSegmentBuilder;\n\n});\n\nparcelRegister(\"8MHlY\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $a9484abfa4e647eb$export$2e2bcd8739ae039; });\n\nvar $lwczO = parcelRequire(\"lwczO\");\n\nvar $2FQv2 = parcelRequire(\"2FQv2\");\nconst $a9484abfa4e647eb$var$nexxenSegmentBuilder = (beacons)=>{\n    const { pageVisitorBeaconId: pageVisitorBeaconId, transactionBeaconId: transactionBeaconId } = beacons;\n    return {\n        emit: ()=>{\n            if (!pageVisitorBeaconId) return;\n            (0, $lwczO.default).info(\"Building s2 segment with segmentId: \", pageVisitorBeaconId);\n            const pix = (0, $2FQv2.default)(`https://r.turn.com/r/beacon?b2=${pageVisitorBeaconId}`);\n            document.head.appendChild(pix);\n        },\n        emitPurchase: (input)=>{\n            const { cid: cid, bprice: bprice } = input;\n            if (!cid || !bprice || !transactionBeaconId) {\n                console.warn(\"Missing required data for s2.tr\");\n                return;\n            }\n            (0, $lwczO.default).info(\"Emitting purchase event for segmentId: \", transactionBeaconId);\n            const pix = (0, $2FQv2.default)(`https://r.turn.com/r/beacon?b2=${transactionBeaconId}&cid=${cid}&bprice=${bprice}`);\n            document.head.appendChild(pix);\n        }\n    };\n};\nvar $a9484abfa4e647eb$export$2e2bcd8739ae039 = $a9484abfa4e647eb$var$nexxenSegmentBuilder;\n\n});\nparcelRegister(\"2FQv2\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $7320f870626fdaba$export$2e2bcd8739ae039; });\nconst $7320f870626fdaba$var$createImagePixel = (url)=>{\n    const pixel = document.createElement(\"img\");\n    pixel.src = url;\n    // Ensure it's 1x1 pixel in size\n    pixel.width = 1;\n    pixel.height = 1;\n    // Make it invisible\n    pixel.style.position = \"absolute\";\n    pixel.style.left = \"-9999px\";\n    return pixel;\n};\nvar $7320f870626fdaba$export$2e2bcd8739ae039 = $7320f870626fdaba$var$createImagePixel;\n\n});\n\n\nparcelRegister(\"brv19\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $c0eda113f7e844bf$export$2e2bcd8739ae039; });\n\nvar $lwczO = parcelRequire(\"lwczO\");\n\nvar $2FQv2 = parcelRequire(\"2FQv2\");\nconst $c0eda113f7e844bf$var$DstillerySegmentBuilderInput = (input)=>{\n    const { siteVisitorNC: siteVisitorNC, purchaseNC: purchaseNC } = input;\n    return {\n        emit: ()=>{\n            if (!siteVisitorNC) return;\n            (0, $lwczO.default).info(\"Building s3 segment with segmentId: \", siteVisitorNC);\n            const pix = (0, $2FQv2.default)(`https://action.dstillery.com/orbserv/nsjs?adv=cl172365597545365&ns=8779&nc=${siteVisitorNC}&ncv=76`);\n            document.head.appendChild(pix);\n        },\n        emitPurchase: (input)=>{\n            const { orderId: orderId, amount: amount } = input;\n            if (!orderId || !amount || !purchaseNC) {\n                console.warn(\"Missing required data for s3.tr\");\n                return;\n            }\n            (0, $lwczO.default).info(\"Emitting dstillery purchase event for segmentId: \", purchaseNC);\n            const pix = (0, $2FQv2.default)(`https://action.dstillery.com/orbserv/nsjs?adv=cl172365597545365&ns=8779&nc=${purchaseNC}&ncv=76&dstOrderId=${orderId}&dstOrderAmount=${amount}`);\n            document.head.appendChild(pix);\n        }\n    };\n};\nvar $c0eda113f7e844bf$export$2e2bcd8739ae039 = $c0eda113f7e844bf$var$DstillerySegmentBuilderInput;\n\n});\n\n\nparcelRegister(\"cdX3u\", function(module, exports) {\n\n});\n\n\n\nparcelRegister(\"2JcTW\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $e28752228a952a06$export$2e2bcd8739ae039; });\n\nvar $lwczO = parcelRequire(\"lwczO\");\nconst $e28752228a952a06$var$setupExtension = (context)=>{\n    // Fail fast if the required params are not present\n    if (!context.conversionId || !context.conversionLabel) console.warn(\"Conversion ID and Conversion Label are required for Google Ads\");\n    if (!context.conversionId.includes(\"AW-\")) context.conversionId = `AW-${context.conversionId}`;\n    (0, $lwczO.default).info(`\\u{1F680}\\u{1F680}\\u{1F680} Google Ads Plugin loaded for ${context.environment}`);\n    document.createElement(\"script\").src = `https://www.googletagmanager.com/gtag/js?id=${context.conversionId}`;\n    window.dataLayer = window.dataLayer || [];\n    function gtag() {\n        window.dataLayer.push(arguments);\n    }\n    window.gtag = gtag;\n    /**Note: the @ts-ignore lines below are necessary to supress typescript warnings for the arguments object above */ // @ts-ignore\n    gtag(\"js\", new Date());\n    // @ts-ignore\n    gtag(\"config\", context.conversionId);\n    // Cross domain tracking\n    if (context.crossDomainSites) {\n        const crossDomainSites = context.crossDomainSites.split(\",\");\n        const sites = crossDomainSites.map((site)=>site.trim());\n        // @ts-ignore\n        gtag(\"set\", \"linker\", {\n            domains: sites\n        });\n    }\n};\n/**\n * This extension will send Google ads conversion events when a transaction is tracked\n */ const $e28752228a952a06$var$withSnowplowGoogleAdsExtension = (snowplow)=>{\n    let { conversionId: conversionId, conversionLabel: conversionLabel } = snowplow.context;\n    if (!conversionId.includes(\"AW-\")) conversionId = `AW-${conversionId}`;\n    $e28752228a952a06$var$setupExtension(snowplow.context);\n    // Original trackTransaction method\n    const trackTransaction = snowplow.ecommerce.trackTransaction;\n    //* Override the trackTransaction method\n    snowplow.ecommerce.trackTransaction = (input)=>{\n        trackTransaction(input);\n        (0, $lwczO.default).info(`\\u{1F680}\\u{1F680}\\u{1F680} Google Ads Extension Transaction Event`, {\n            send_to: `${conversionId}/${conversionLabel}`,\n            value: input.total,\n            currency: input.currency,\n            transaction_id: input.id\n        });\n        window.gtag(\"event\", \"conversion\", {\n            send_to: `${conversionId}/${conversionLabel}`,\n            value: input.total,\n            currency: input.currency,\n            transaction_id: input.id\n        });\n    };\n    return snowplow;\n};\nvar $e28752228a952a06$export$2e2bcd8739ae039 = $e28752228a952a06$var$withSnowplowGoogleAdsExtension;\n\n});\n\nparcelRegister(\"iKE1G\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $b7d4fe9e37bf4000$export$2e2bcd8739ae039; });\n\nvar $lwczO = parcelRequire(\"lwczO\");\nconst $b7d4fe9e37bf4000$var$setupExtension = (context)=>{\n    const script = document.createElement(\"script\");\n    script.type = \"text/javascript\";\n    script.innerHTML = `(function(w,d,t,r,u){var f,n,i;w[u]=w[u]||[],f=function(){var o={ti:${context.tagId}};o.q=w[u],w[u]=new UET(o),w[u].push(\"pageLoad\")},n=d.createElement(t),n.src=r,n.async=1,n.onload=n.onreadystatechange=function(){var s=this.readyState;s&&s!==\"loaded\"&&s!==\"complete\"||(f(),n.onload=n.onreadystatechange=null)},i=d.getElementsByTagName(t)[0],i.parentNode.insertBefore(n,i)})(window,document,\"script\",\"//bat.bing.com/bat.js\",\"uetq\");`;\n    document.head.appendChild(script);\n    window.uetq = window.uetq || [];\n};\n/**\n * This extension will send Bing Ads conversion events when a transaction is tracked\n */ const $b7d4fe9e37bf4000$var$withSnowplowBingAdsExtension = (snowplow)=>{\n    $b7d4fe9e37bf4000$var$setupExtension(snowplow.context);\n    // Original trackTransaction method\n    const trackTransaction = snowplow.ecommerce.trackTransaction;\n    //* Override the trackTransaction method\n    snowplow.ecommerce.trackTransaction = (input)=>{\n        trackTransaction(input);\n        (0, $lwczO.default).info(`\\u{1F680}\\u{1F680}\\u{1F680} Bing Ads Extension Transaction Event`, {\n            transaction_id: input.id,\n            ecomm_prodid: input.items.map((item)=>item.sku),\n            ecomm_pagetype: \"purchase\",\n            ecomm_totalvalue: input.total,\n            revenue_value: input.total,\n            currency: \"USD\",\n            items: input.items.map((item)=>({\n                    id: item.sku,\n                    quantity: item.quantity,\n                    price: item.unitPrice\n                }))\n        });\n        window.uetq.push(\"event\", \"purchase\", {\n            transaction_id: input.id,\n            ecomm_prodid: input.items.map((item)=>item.sku),\n            ecomm_pagetype: \"purchase\",\n            ecomm_totalvalue: input.total,\n            revenue_value: input.total,\n            currency: \"USD\",\n            items: input.items.map((item)=>({\n                    id: item.sku,\n                    quantity: item.quantity,\n                    price: item.unitPrice\n                }))\n        });\n    };\n    return snowplow;\n};\nvar $b7d4fe9e37bf4000$export$2e2bcd8739ae039 = $b7d4fe9e37bf4000$var$withSnowplowBingAdsExtension;\n\n});\n\nparcelRegister(\"iN4ie\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $2698e4ae6f73631d$export$2e2bcd8739ae039; });\n\nvar $lwczO = parcelRequire(\"lwczO\");\n// add a check to check if the jsonString is an array\nfunction $2698e4ae6f73631d$var$tryParseJSONObject(jsonString) {\n    try {\n        var o = JSON.parse(jsonString);\n        if (o && typeof o === \"object\") return {\n            type: \"object\",\n            value: o\n        };\n        if (Array.isArray(o)) return {\n            type: \"array\",\n            value: o\n        };\n        return {\n            type: \"string\",\n            value: jsonString\n        };\n    } catch (e) {\n        return {\n            type: \"string\",\n            value: jsonString\n        };\n    }\n}\nconst $2698e4ae6f73631d$var$withDeduplicationExtension = (snowplow)=>{\n    const logger = (0, $lwczO.createLogger)(\"MJ:Deduplication\");\n    const { trackTransaction: originalTrackTransaction, trackAddToCart: originalTrackAddToCart, trackRemoveFromCart: originalTrackRemoveFromCart } = snowplow.ecommerce;\n    const { trackSignup: originalTrackSignup } = snowplow;\n    const getStorageKey = (eventType)=>`${snowplow.context.appId}_${eventType}`;\n    const deduplicateEvent = (originalMethod, eventType, input, idField)=>{\n        const storageKey = getStorageKey(eventType);\n        const eventId = idField.map((key)=>input[key]).join(\":\");\n        let value = localStorage.getItem(storageKey);\n        let existingIds = [];\n        if (value) {\n            const parsed = $2698e4ae6f73631d$var$tryParseJSONObject(value);\n            if ((parsed === null || parsed === void 0 ? void 0 : parsed.type) === \"object\") existingIds = parsed.value;\n            else if ((parsed === null || parsed === void 0 ? void 0 : parsed.type) === \"string\") existingIds = [\n                parsed.value\n            ];\n        }\n        console.log(\"existingIds\", existingIds);\n        if (existingIds.includes(eventId)) {\n            logger.warn(`${eventType} with id ${eventId} already tracked. Discarding duplicate.`);\n            return;\n        }\n        originalMethod(input);\n        localStorage.setItem(storageKey, JSON.stringify([\n            ...existingIds,\n            eventId\n        ]));\n    };\n    snowplow.ecommerce.trackTransaction = (input)=>deduplicateEvent(originalTrackTransaction, \"transaction\", input, [\n            \"id\"\n        ]);\n    snowplow.ecommerce.trackAddToCart = (input)=>deduplicateEvent(originalTrackAddToCart, \"addToCart\", input, [\n            \"name\",\n            \"quantity\"\n        ]);\n    snowplow.ecommerce.trackRemoveFromCart = (input)=>deduplicateEvent(originalTrackRemoveFromCart, \"removeFromCart\", input, [\n            \"name\",\n            \"quantity\"\n        ]);\n    snowplow.trackSignup = (input)=>deduplicateEvent(originalTrackSignup, \"signUp\", input, [\n            \"uuid\",\n            \"emailAddress\"\n        ]);\n    return snowplow;\n};\nvar $2698e4ae6f73631d$export$2e2bcd8739ae039 = $2698e4ae6f73631d$var$withDeduplicationExtension;\n\n});\n\n\nparcelRegister(\"cmhQG\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $b18efba9eb457c03$export$2e2bcd8739ae039; });\n/**\n *\n * This extension ensures that the orderId for the basket items is the same as the orderId for the transaction.\n * This is important for Shopify integrations since the orderId for the basket items is the product id and not the order id.\n */ const $b18efba9eb457c03$var$withEnsureBasketItemsOrderId = (snowplow)=>{\n    const trackTransaction = snowplow.ecommerce.trackTransaction;\n    snowplow.ecommerce.trackTransaction = (input)=>{\n        trackTransaction({\n            id: input.id,\n            affiliateId: input.affiliateId,\n            total: input.total,\n            tax: input.tax,\n            shipping: input.shipping,\n            city: input.city,\n            state: input.state,\n            country: input.country,\n            currency: input.currency,\n            discount: input.discount,\n            couponCode: input.couponCode,\n            alternativeTransactionIds: input.alternativeTransactionIds,\n            items: input.items.map((item)=>({\n                    orderId: input.id,\n                    sku: item.sku,\n                    name: item.name,\n                    category: item.category,\n                    unitPrice: item.unitPrice,\n                    quantity: item.quantity,\n                    currency: item.currency\n                }))\n        });\n    };\n    return snowplow;\n};\nvar $b18efba9eb457c03$export$2e2bcd8739ae039 = $b18efba9eb457c03$var$withEnsureBasketItemsOrderId;\n\n});\n\nparcelRegister(\"bhLWo\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $71e7d74cb31b3edc$export$2e2bcd8739ae039; });\nlet $71e7d74cb31b3edc$var$thirdPartyTags = {};\nconst $71e7d74cb31b3edc$var$registerThirdPartyTags = (input)=>{\n    $71e7d74cb31b3edc$var$thirdPartyTags = input;\n};\nwindow.registerThirdPartyTags = $71e7d74cb31b3edc$var$registerThirdPartyTags;\nconst $71e7d74cb31b3edc$var$replaceMacros = (tag, placeholders)=>tag.replace(/{\\w+}/g, (match)=>placeholders[match] || match);\nconst $71e7d74cb31b3edc$var$createElementForTag = (type, tagWithMacros)=>{\n    if (type === \"script\") {\n        const script = document.createElement(\"script\");\n        script.src = tagWithMacros;\n        script.async = true;\n        document.body.appendChild(script);\n    } else if (type === \"image\") {\n        const img = new Image();\n        img.src = tagWithMacros;\n        document.body.appendChild(img);\n    }\n};\nconst $71e7d74cb31b3edc$var$processTags = (tags, placeholders)=>{\n    tags === null || tags === void 0 ? void 0 : tags.forEach(({ tag: tag, type: type })=>{\n        const tagWithMacros = $71e7d74cb31b3edc$var$replaceMacros(tag, placeholders);\n        $71e7d74cb31b3edc$var$createElementForTag(type, tagWithMacros);\n    });\n};\nconst $71e7d74cb31b3edc$var$withRegisterThirdPartyTagsExtension = (snowplow)=>{\n    const { trackTransaction: trackTransaction, trackAddToCart: trackAddToCart, trackRemoveFromCart: trackRemoveFromCart } = snowplow.ecommerce;\n    const { trackSignup: trackSignup } = snowplow;\n    snowplow.ecommerce.trackTransaction = (input)=>{\n        var _input_id, _input_total, _input_tax, _input_shipping, _input_userId;\n        trackTransaction(input);\n        $71e7d74cb31b3edc$var$processTags($71e7d74cb31b3edc$var$thirdPartyTags.onTransaction, {\n            \"{transaction_id}\": (input === null || input === void 0 ? void 0 : (_input_id = input.id) === null || _input_id === void 0 ? void 0 : _input_id.toString()) || \"null\",\n            \"{transaction_total}\": (input === null || input === void 0 ? void 0 : (_input_total = input.total) === null || _input_total === void 0 ? void 0 : _input_total.toString()) || \"0\",\n            \"{transaction_tax}\": (input === null || input === void 0 ? void 0 : (_input_tax = input.tax) === null || _input_tax === void 0 ? void 0 : _input_tax.toString()) || \"0\",\n            \"{transaction_shipping}\": (input === null || input === void 0 ? void 0 : (_input_shipping = input.shipping) === null || _input_shipping === void 0 ? void 0 : _input_shipping.toString()) || \"0\",\n            \"{transaction_city}\": (input === null || input === void 0 ? void 0 : input.city) || \"null\",\n            \"{transaction_state}\": (input === null || input === void 0 ? void 0 : input.state) || \"null\",\n            \"{transaction_country}\": (input === null || input === void 0 ? void 0 : input.country) || \"null\",\n            \"{transaction_currency}\": (input === null || input === void 0 ? void 0 : input.currency) || \"null\",\n            \"{transaction_userId}\": (input === null || input === void 0 ? void 0 : (_input_userId = input.userId) === null || _input_userId === void 0 ? void 0 : _input_userId.toString()) || \"null\"\n        });\n    };\n    snowplow.ecommerce.trackAddToCart = (input)=>{\n        var _input_unitPrice, _input_quantity, _input_userId;\n        trackAddToCart(input);\n        $71e7d74cb31b3edc$var$processTags($71e7d74cb31b3edc$var$thirdPartyTags.onAddToCart, {\n            \"{cart_id}\": (input === null || input === void 0 ? void 0 : input.sku) || \"null\",\n            \"{cart_name}\": (input === null || input === void 0 ? void 0 : input.name) || \"null\",\n            \"{cart_category}\": (input === null || input === void 0 ? void 0 : input.category) || \"null\",\n            \"{cart_unitPrice}\": (input === null || input === void 0 ? void 0 : (_input_unitPrice = input.unitPrice) === null || _input_unitPrice === void 0 ? void 0 : _input_unitPrice.toString()) || \"0\",\n            \"{cart_quantity}\": (input === null || input === void 0 ? void 0 : (_input_quantity = input.quantity) === null || _input_quantity === void 0 ? void 0 : _input_quantity.toString()) || \"0\",\n            \"{cart_currency}\": (input === null || input === void 0 ? void 0 : input.currency) || \"null\",\n            \"{cart_userId}\": (input === null || input === void 0 ? void 0 : (_input_userId = input.userId) === null || _input_userId === void 0 ? void 0 : _input_userId.toString()) || \"null\"\n        });\n    };\n    snowplow.ecommerce.trackRemoveFromCart = (input)=>{\n        var _input_unitPrice, _input_quantity, _input_userId;\n        trackRemoveFromCart(input);\n        $71e7d74cb31b3edc$var$processTags($71e7d74cb31b3edc$var$thirdPartyTags.onRemoveFromCart, {\n            \"{cart_id}\": (input === null || input === void 0 ? void 0 : input.sku) || \"null\",\n            \"{cart_name}\": (input === null || input === void 0 ? void 0 : input.name) || \"null\",\n            \"{cart_category}\": (input === null || input === void 0 ? void 0 : input.category) || \"null\",\n            \"{cart_unitPrice}\": (input === null || input === void 0 ? void 0 : (_input_unitPrice = input.unitPrice) === null || _input_unitPrice === void 0 ? void 0 : _input_unitPrice.toString()) || \"0\",\n            \"{cart_quantity}\": (input === null || input === void 0 ? void 0 : (_input_quantity = input.quantity) === null || _input_quantity === void 0 ? void 0 : _input_quantity.toString()) || \"0\",\n            \"{cart_currency}\": (input === null || input === void 0 ? void 0 : input.currency) || \"null\",\n            \"{cart_userId}\": (input === null || input === void 0 ? void 0 : (_input_userId = input.userId) === null || _input_userId === void 0 ? void 0 : _input_userId.toString()) || \"null\"\n        });\n    };\n    snowplow.trackSignup = (input)=>{\n        trackSignup(input);\n        $71e7d74cb31b3edc$var$processTags($71e7d74cb31b3edc$var$thirdPartyTags.onSignup, {\n            \"{signup_firstName}\": (input === null || input === void 0 ? void 0 : input.firstName) || \"null\",\n            \"{signup_lastName}\": (input === null || input === void 0 ? void 0 : input.lastName) || \"null\",\n            \"{signup_uuid}\": (input === null || input === void 0 ? void 0 : input.uuid) || \"null\",\n            \"{signup_email}\": (input === null || input === void 0 ? void 0 : input.emailAddress) || \"null\",\n            \"{signup_address}\": (input === null || input === void 0 ? void 0 : input.address) || \"null\",\n            \"{signup_city}\": (input === null || input === void 0 ? void 0 : input.city) || \"null\",\n            \"{signup_state}\": (input === null || input === void 0 ? void 0 : input.state) || \"null\",\n            \"{signup_phone}\": (input === null || input === void 0 ? void 0 : input.phoneNumber) || \"null\",\n            \"{signup_advertiser}\": (input === null || input === void 0 ? void 0 : input.advertiser) || \"null\"\n        });\n    };\n    return snowplow;\n};\nvar $71e7d74cb31b3edc$export$2e2bcd8739ae039 = $71e7d74cb31b3edc$var$withRegisterThirdPartyTagsExtension;\n\n});\n\nparcelRegister(\"gjtns\", function(module, exports) {\n\n\nmodule.exports = (parcelRequire(\"aiXW3\"))((parcelRequire(\"7SZEv\")).resolve(\"9DPLo\")).then(()=>parcelRequire(\"7rUq7\"));\n\n});\n\nparcelRegister(\"jV2KE\", function(module, exports) {\n\n\nmodule.exports = (parcelRequire(\"aiXW3\"))((parcelRequire(\"7SZEv\")).resolve(\"6x0lw\")).then(()=>parcelRequire(\"54bLn\"));\n\n});\n\n\n})();\n//# sourceMappingURL=adapters.6626997d.js.map\n","import logger from \"src/shared/logger\";\nimport { createSnowplowTracker } from \"src/shared/snowplow\";\nimport {\n  applyExtensions,\n  withSnowplowSegmentsExtension,\n  withDeduplicationExtension,\n} from \"src/shared/snowplow/extensions\";\nimport withEnsureBasketItemsOrderId from \"src/shared/snowplow/extensions/ensure-basket-items-order-id\";\nimport withRegisterThirdPartyTagsExtension from \"src/shared/snowplow/extensions/register-third-party-tags\";\nimport { QueryStringContext } from \"src/shared/types\";\n\nconst loadAdapters = async (context: QueryStringContext): Promise<void> => {\n  const plugins = context?.plugin?.split(\",\") || [];\n  const snowplow = await createSnowplowTracker(context);\n\n  // Apply extensions to the tracker\n  const tracker = applyExtensions(snowplow, [\n    withDeduplicationExtension,\n    withEnsureBasketItemsOrderId,\n    withRegisterThirdPartyTagsExtension,\n    withSnowplowSegmentsExtension,\n    /** Dynamically add Google Ads plugin/extension */\n    plugins.includes(\"googleAds\") &&\n      (await import(\"src/shared/snowplow/extensions\").then(({ withGoogleAdsExtension }) => withGoogleAdsExtension)),\n    /** Dynamically add Bing Ads plugin/extension */\n    plugins.includes(\"bingAds\") &&\n      (await import(\"src/shared/snowplow/extensions\").then(({ withBingAdsExtension }) => withBingAdsExtension)),\n  ]);\n\n  window.trackTrans = tracker.ecommerce.trackTransaction;\n  window.trackSignUp = tracker.trackSignup;\n  window.addToCart = tracker.ecommerce.trackAddToCart;\n  window.removeFromCart = tracker.ecommerce.trackRemoveFromCart;\n\n  switch (context.event) {\n    case \"transaction\":\n      import(\"./ecommerce\").then(({ default: load }): Promise<void> => load(tracker));\n      break;\n    case \"impression\":\n      import(\"./impressions\").then(({ default: load }): Promise<void> => load(tracker));\n      break;\n    case \"signup\":\n      tracker.trackSignup(context);\n      break;\n    default:\n      if (!context.environment) {\n        logger.warn(\"No event/environment specified, Only pageview is active\");\n        return;\n      }\n      import(\"./ecommerce\").then(({ default: load }): Promise<void> => load(tracker));\n      logger.warn(`No event specified, Loading ${context.environment}`);\n  }\n};\n\nexport default loadAdapters;\n","export * from \"./types\";\nexport { default as createSnowplowTracker } from \"./tracker\";\n","import {\n    CartEvent, ImpressionsMacrosParams, QueryStringContext, SignupParams, TransactionEvent\n} from 'src/shared/types';\n\nexport interface SnowplowTrackerInitializeInput {\n  appId: string;\n  collector: string;\n  event: string;\n}\nexport interface SnowplowTracker {\n  initialize: (input: SnowplowTrackerInitializeInput) => void;\n  /** Mainly used for book-keeping purposes so we can document params & the tag itself */\n  record: (input: QueryStringContext) => void;\n  ecommerce: SnowplowTrackerEcommerceEvents;\n  impressions?: SnowplowTrackerImpressionEvents;\n  /** Used for tracking a signup when rendering the tag, acts like an image tag */\n  trackSignup: (input: Partial<SignupParams>) => void;\n  /** Properties of the integration tracker url */\n  context: QueryStringContext;\n}\n\nexport interface SnowplowTrackerEcommerceEvents {\n  trackTransaction: (input: TransactionEvent) => void;\n  trackAddToCart: (input: CartEvent) => void;\n  trackRemoveFromCart: (input: CartEvent) => void;\n}\n\nexport interface SnowplowTrackerImpressionEvents {\n  trackLiquidmImpression: (input: Partial<ImpressionsMacrosParams>) => void;\n  trackMantisImpression: (input: Partial<ImpressionsMacrosParams>) => void;\n  trackSimplifiImpression: (input: Partial<ImpressionsMacrosParams>) => void;\n}\n\nexport interface CreateSnowplowTrackerInput extends QueryStringContext {}\n\nexport { TransactionEvent, CartEvent, SignupParams };\n\n","export interface CartEvent {\n  sku: string;\n  name: string;\n  category: string;\n  unitPrice: number;\n  quantity: number;\n  currency: string;\n  userId?: string;\n}\n\nexport interface TransactionCartItem extends CartEvent {\n  orderId: string;\n}\n\nexport interface TransactionEvent {\n  id: string;\n\n  affiliateId?: string;\n  total: number;\n  tax: number;\n  shipping: number;\n  city: string;\n  state: string;\n  country: string;\n  currency: string;\n  userId?: string;\n  discount?: number;\n  couponCode?: string;\n  alternativeTransactionIds?: string[];\n  items: TransactionCartItem[];\n}\n\nexport interface EnvironmentEvents {\n  addToCartEvent: (cartData: CartEvent) => void;\n  removeFromCartEvent: (cartData: CartEvent) => void;\n  transactionEvent: (transactionData: TransactionEvent) => void;\n}\n\nexport interface EventsObservableEvents {\n  transactionEvent: TransactionEvent;\n  addToCartEvent: CartEvent;\n  removeFromCartEvent: CartEvent;\n}\n\nexport interface ThirdPartyTags {\n  type: \"image\" | \"script\";\n  tag: string;\n}\n\nexport interface RegisterThirdPartyTagsInput {\n  onTransaction?: ThirdPartyTags[];\n  onAddToCart?: ThirdPartyTags[];\n  onRemoveFromCart?: ThirdPartyTags[];\n  onSignup?: ThirdPartyTags[];\n}\n\n// Data structure of the tag after parsing\nexport type TransactionParams = {\n  environment: string;\n  retailId: string;\n};\n\nexport type SignupParams = {\n  uuid: string;\n  firstName: string;\n  lastName: string;\n  gender: string;\n  emailAddress: string;\n  hashedEmailAddress: string;\n  address: string;\n  city: string;\n  state: string;\n  phoneNumber: string;\n  advertiser: string;\n};\n\nexport type SnowplowParams = {\n  appId: string;\n  mediajelAppId?: string;\n  environment: string;\n  event: \"impression\" | \"transaction\" | \"signup\" | \"googleAds\";\n  test: string;\n  version: string;\n  tag: string;\n};\n\nexport type SnowplowPluginParams = {\n  debugger: string;\n};\n\nexport type PluginParams = {\n  plugin?: \"googleAds\" | \"bingAds\";\n};\n\nexport type GoogleAdsPluginParams = {\n  conversionId: string;\n  conversionLabel: string;\n  value?: number;\n  currency?: string;\n  transactionId?: string;\n  crossDomainSites?: string; // Must be a comma separated string (I.E. \"www.example.com,www.example2.com\")\n} & Pick<SnowplowParams, \"environment\">;\n\nexport type BingAdsPluginParams = {\n  tagId: string;\n} & Pick<SnowplowParams, \"environment\">;\n\nexport type ImpressionsMacrosParams = {\n  advertiserId: string;\n  advertiserName: string;\n  insertionOrder: string;\n  lineItemId: string;\n  creativeId: string;\n  publisherId: string;\n  publisherName: string;\n  siteId: string;\n  siteName: string;\n  liquidmAppId: string;\n  appName: string;\n  clickId: string;\n  GAID: string;\n  GAID_MD5: string;\n  GAID_SHA1: string;\n  IDFA: string;\n  IDFA_MD5: string;\n  IDFA_SHA1: string;\n  DSPIDENTIFIER: string;\n  DEVICEID: string;\n  MAXMIND_CON_TYPE_NAME: string;\n  MAXMIND_GEO_IDS: string;\n  MAXMIND_ISP_ID: string;\n};\n\nexport type LiquidmSegmentParams = {\n  s1: string;\n  segmentId: string;\n};\n\nexport type NexxenSegmentParams = {\n  //* Parameter used for identifying the nexxen beacon for visitor tracking & conversion tracking (Legacy)\n  s2: string;\n  // * Parameter used for identifyin the nexxen beacon for visitor tracking\n  \"s2.pv\": string;\n  // * Parameter used for identifying the nexxen beacon for conversion tracking\n  \"s2.tr\": string;\n};\n\nexport type DstillerySegmentParams = {\n  // Site Visitor NC\n  \"s3.pv\": string;\n  // Purchase NC\n  \"s3.tr\": string;\n};\n\nexport type SegmentParams = LiquidmSegmentParams & NexxenSegmentParams & DstillerySegmentParams;\n\nexport type DatasourceTrackerParam = {\n  debug: string;\n};\n\nexport type QueryStringParams = Partial<TransactionParams> &\n  Partial<SignupParams> &\n  Partial<SnowplowPluginParams> &\n  Partial<ImpressionsMacrosParams> &\n  Partial<PluginParams> &\n  GoogleAdsPluginParams &\n  BingAdsPluginParams &\n  SnowplowParams &\n  SegmentParams &\n  DatasourceTrackerParam;\n\n// Params available to the tag's query string\nexport type QueryStringContext = QueryStringParams & { collector: string };\nexport interface Window {\n  trackTrans: (input: TransactionEvent) => void;\n}\n","import logger from 'src/shared/logger';\nimport { CreateSnowplowTrackerInput, SnowplowTracker } from 'src/shared/snowplow/types';\n\nconst createSnowplowTracker = async (input: CreateSnowplowTrackerInput): Promise<SnowplowTracker> => {\n  const { appId, collector, event } = input;\n  logger.info(`Creating Snowplow tracker for version ${input.version}`);\n  const isLegacyTracker = input.version === \"1\";\n\n  const createSnowplowV1Tracker = async () => {\n    return await import(`src/shared/snowplow/v1/tracker`).then(\n      async ({ default: createSnowplowV1Tracker }) => await createSnowplowV1Tracker(input)\n    );\n  };\n\n  const createSnowplowV2Tracker = async () => {\n    return await import(`src/shared/snowplow/v2/tracker`).then(\n      async ({ default: createSnowplowV2Tracker }) => await createSnowplowV2Tracker(input)\n    );\n  };\n\n  const tracker = isLegacyTracker ? await createSnowplowV1Tracker() : await createSnowplowV2Tracker();\n\n  tracker.initialize({ appId, collector, event });\n  tracker.record(input);\n\n  return tracker;\n};\n\nexport default createSnowplowTracker;\n","module.exports = (require(\"./helpers/browser/js-loader\")(require('./helpers/bundle-manifest').resolve(\"32qsa\"))).then(() => parcelRequire('a7EfY'));","module.exports = (require(\"./helpers/browser/js-loader\")(require('./helpers/bundle-manifest').resolve(\"dqqna\"))).then(() => parcelRequire('dFSGc'));","import { SnowplowTracker } from 'src/shared/snowplow/types';\n\nexport {default as withSnowplowSegmentsExtension} from './segments';\nexport {default as withGoogleAdsExtension} from './google-ads';\nexport {default as withBingAdsExtension} from './bing-ads';\nexport {default as withDeduplicationExtension} from './deduplicator';\n\nexport const applyExtensions = (\n  tracker: SnowplowTracker,\n  // Either load a function or undefined for dynamic loading\n  extensions: ((tracker: SnowplowTracker) => SnowplowTracker)[] | undefined\n): SnowplowTracker => {\n  return extensions.reduce((currentTracker, extension) => extension ? extension(currentTracker): currentTracker, tracker);\n};","import { createSegments, DstillerySegmentBuilderInput, NexxenSegmentBuilderInput } from \"src/shared/segment-builder\";\nimport { SnowplowTracker } from \"src/shared/snowplow/types\";\nimport { QueryStringContext } from \"src/shared/types\";\n\nconst setupExtension = (context: QueryStringContext): ReturnType<typeof createSegments> => {\n  const liquidm = context.segmentId || context.s1;\n\n  //* If s2.pv or s2.tr is not present, use context.s2 as default\n  //* mainly used for legacy purposes\n  const nexxen: NexxenSegmentBuilderInput = {\n    pageVisitorBeaconId: context[\"s2.pv\"] || context[\"s2\"],\n    transactionBeaconId: context[\"s2.tr\"] || context[\"s2\"],\n  };\n\n  const dstillery: DstillerySegmentBuilderInput = {\n    siteVisitorNC: context[\"s3.pv\"] || context[\"s3\"],\n    purchaseNC: context[\"s3.tr\"] || context[\"s3\"],\n  };\n\n  const segments = createSegments({\n    //* Accept both segmentId and s1 for legacy purposes\n    liquidm,\n    nexxen,\n    dstillery,\n  });\n\n  //* Expose cnnaSegments to the window object for custom integrations to use\n  window.cnnaSegments = segments;\n\n  liquidm && segments.liquidm.emit();\n  nexxen && segments.nexxen.emit();\n  dstillery && segments.dstillery.emit();\n\n  return segments;\n};\n\n/**\n * This extension will send transaction events to our partner segments when a transaction is tracked\n */\n\nconst withSnowplowSegmentsExtension = (snowplow: SnowplowTracker) => {\n  const segments = setupExtension(snowplow.context);\n\n  // Original trackTransaction method\n  const trackTransaction = snowplow.ecommerce.trackTransaction;\n\n  //* Override the trackTransaction method\n  snowplow.ecommerce.trackTransaction = (input) => {\n    trackTransaction(input);\n\n    segments.nexxen.emitPurchase({\n      bprice: input.total,\n      cid: input.id,\n    });\n\n    segments.dstillery.emitPurchase({\n      amount: input.total,\n      orderId: input.id,\n    });\n  };\n  return snowplow;\n};\n\nexport default withSnowplowSegmentsExtension;\n","export { default as createSegments } from \"./builder\";\nexport * from \"./types\";\n","import liquidmSegmentBuilder from \"src/shared/segment-builder/segments/liquidm\";\nimport nexxenSegmentBuilder from \"src/shared/segment-builder/segments/nexxen\";\nimport DstillerySegmentBuilderInput from \"src/shared/segment-builder/segments/dstillery\";\nimport { SegmentBuilderInput } from \"src/shared/segment-builder/types\";\n\nconst createSegments = (input: SegmentBuilderInput) => {\n  const { liquidm, nexxen, dstillery } = input;\n\n  return {\n    nexxen: nexxenSegmentBuilder(nexxen),\n    liquidm: liquidmSegmentBuilder(liquidm),\n    dstillery: DstillerySegmentBuilderInput(dstillery),\n  };\n};\n\nexport default createSegments;\n","import logger from 'src/shared/logger';\n\nconst liquidmSegmentBuilder = (segmentId: string) => {\n  return {\n    emit: () => {\n      logger.info(\"Building s1 segment with segmentId: \", segmentId);\n      (function (c, d) {\n        var a = document.createElement(\"script\");\n        a.type = \"text/javascript\";\n        a.async = !0;\n        a.src =\n          `https://tracking.lqm.io/odin/handle_sync.js?seg=${segmentId}&gdpr=` +\n          (\"1\" === c ? \"1\" : \"0\") +\n          \"&gdpr_consent=\" +\n          (d ? encodeURIComponent(d) : \"\") +\n          \"&cb=\" +\n          new Date().getTime();\n        var b = document.getElementsByTagName(\"script\")[0];\n        b.parentNode.insertBefore(a, b);\n      })();\n    },\n  };\n};\n\nexport default liquidmSegmentBuilder;\n","import logger from \"src/shared/logger\";\nimport { NexxenSegmentBuilderInput } from \"src/shared/segment-builder/types\";\nimport createImagePixel from \"src/shared/utils/create-image-pixel\";\n\ninterface EmitPurchaseInput {\n  cid: string;\n  bprice: number;\n}\nconst nexxenSegmentBuilder = (beacons: NexxenSegmentBuilderInput) => {\n  const { pageVisitorBeaconId, transactionBeaconId } = beacons;\n  return {\n    emit: () => {\n      if (!pageVisitorBeaconId) return;\n      logger.info(\"Building s2 segment with segmentId: \", pageVisitorBeaconId);\n      const pix = createImagePixel(`https://r.turn.com/r/beacon?b2=${pageVisitorBeaconId}`);\n      document.head.appendChild(pix);\n    },\n\n    emitPurchase: (input: EmitPurchaseInput) => {\n      const { cid, bprice } = input;\n\n      if (!cid || !bprice || !transactionBeaconId) {\n        console.warn(\"Missing required data for s2.tr\");\n        return;\n      }\n\n      logger.info(\"Emitting purchase event for segmentId: \", transactionBeaconId);\n\n      const pix =createImagePixel(`https://r.turn.com/r/beacon?b2=${transactionBeaconId}&cid=${cid}&bprice=${bprice}`);\n      document.head.appendChild(pix);\n    },\n  };\n};\n\nexport default nexxenSegmentBuilder;\n","const createImagePixel = (url: string): HTMLImageElement => {\n  const pixel = document.createElement(\"img\");\n\n  pixel.src = url;\n  // Ensure it's 1x1 pixel in size\n  pixel.width = 1;\n  pixel.height = 1;\n\n  // Make it invisible\n  pixel.style.position = \"absolute\";\n  pixel.style.left = \"-9999px\";\n\n  return pixel;\n};\n\nexport default createImagePixel;\n","import { create } from \"cypress/types/lodash\";\nimport logger from \"src/shared/logger\";\nimport { DstillerySegmentBuilderInput } from \"src/shared/segment-builder/types\";\nimport createImagePixel from \"src/shared/utils/create-image-pixel\";\n\ninterface DstilleryInput {\n  orderId: string;\n  amount: number;\n}\n\nconst DstillerySegmentBuilderInput = (input: DstillerySegmentBuilderInput) => {\n  const { siteVisitorNC, purchaseNC } = input;\n\n  return {\n    emit: () => {\n      if (!siteVisitorNC) return;\n      logger.info(\"Building s3 segment with segmentId: \", siteVisitorNC);\n\n      const pix = createImagePixel(\n        `https://action.dstillery.com/orbserv/nsjs?adv=cl172365597545365&ns=8779&nc=${siteVisitorNC}&ncv=76`\n      );\n\n      document.head.appendChild(pix);\n    },\n\n    emitPurchase: (input: DstilleryInput) => {\n      const { orderId, amount } = input;\n\n      if (!orderId || !amount || !purchaseNC) {\n        console.warn(\"Missing required data for s3.tr\");\n        return;\n      }\n\n      logger.info(\"Emitting dstillery purchase event for segmentId: \", purchaseNC);\n\n      const pix = createImagePixel(\n        `https://action.dstillery.com/orbserv/nsjs?adv=cl172365597545365&ns=8779&nc=${purchaseNC}&ncv=76&dstOrderId=${orderId}&dstOrderAmount=${amount}`\n      );\n\n      document.head.appendChild(pix);\n    },\n  };\n};\n\nexport default DstillerySegmentBuilderInput;\n","export interface SegmentBuilderInput {\n  liquidm: string | undefined;\n  nexxen: NexxenSegmentBuilderInput | undefined;\n  dstillery: DstillerySegmentBuilderInput | undefined;\n}\n\nexport interface NexxenSegmentBuilderInput {\n  /** Beacon ID used for tracking page visitors */\n  pageVisitorBeaconId: string;\n  /** Beacon ID used for tracking transactions */\n  transactionBeaconId: string;\n}\n\nexport interface DstillerySegmentBuilderInput {\n  // Dstillery Tag Site Visitor\n  siteVisitorNC: string;\n  // Dstillery Tag Purchase\n  purchaseNC: string;\n}","import logger from \"src/shared/logger\";\nimport { createSegments, DstillerySegmentBuilderInput, NexxenSegmentBuilderInput } from \"src/shared/segment-builder\";\nimport { SnowplowTracker } from \"src/shared/snowplow/types\";\nimport { QueryStringContext } from \"src/shared/types\";\n\nconst setupExtension = (context: QueryStringContext): void => {\n  // Fail fast if the required params are not present\n  if (!context.conversionId || !context.conversionLabel) {\n    console.warn(\"Conversion ID and Conversion Label are required for Google Ads\");\n  }\n\n  if (!context.conversionId.includes(\"AW-\")) {\n    context.conversionId = `AW-${context.conversionId}`;\n  }\n\n  logger.info(` Google Ads Plugin loaded for ${context.environment}`);\n\n  document.createElement(\"script\").src = `https://www.googletagmanager.com/gtag/js?id=${context.conversionId}`;\n\n  window.dataLayer = window.dataLayer || [];\n\n  function gtag() {\n    window.dataLayer.push(arguments);\n  }\n\n  window.gtag = gtag;\n  /**Note: the @ts-ignore lines below are necessary to supress typescript warnings for the arguments object above */\n  // @ts-ignore\n  gtag(\"js\", new Date());\n  // @ts-ignore\n  gtag(\"config\", context.conversionId);\n\n  // Cross domain tracking\n  if (context.crossDomainSites) {\n    const crossDomainSites = context.crossDomainSites.split(\",\");\n    const sites = crossDomainSites.map((site) => site.trim());\n    // @ts-ignore\n    gtag(\"set\", \"linker\", { domains: sites });\n  }\n};\n\n/**\n * This extension will send Google ads conversion events when a transaction is tracked\n */\nconst withSnowplowGoogleAdsExtension = (snowplow: SnowplowTracker) => {\n  let { conversionId, conversionLabel } = snowplow.context;\n\n  if (!conversionId.includes(\"AW-\")) {\n    conversionId = `AW-${conversionId}`;\n  }\n\n  setupExtension(snowplow.context);\n\n  // Original trackTransaction method\n  const trackTransaction = snowplow.ecommerce.trackTransaction;\n\n  //* Override the trackTransaction method\n  snowplow.ecommerce.trackTransaction = (input) => {\n    trackTransaction(input);\n\n    logger.info(` Google Ads Extension Transaction Event`, {\n      send_to: `${conversionId}/${conversionLabel}`,\n      value: input.total,\n      currency: input.currency,\n      transaction_id: input.id,\n    });\n\n    window.gtag(\"event\", \"conversion\", {\n      send_to: `${conversionId}/${conversionLabel}`,\n      value: input.total,\n      currency: input.currency,\n      transaction_id: input.id,\n    });\n  };\n  return snowplow;\n};\n\nexport default withSnowplowGoogleAdsExtension;\n","import logger from \"src/shared/logger\";\nimport { createSegments, DstillerySegmentBuilderInput, NexxenSegmentBuilderInput } from \"src/shared/segment-builder\";\nimport { SnowplowTracker } from \"src/shared/snowplow/types\";\nimport { QueryStringContext } from \"src/shared/types\";\n\nconst setupExtension = (context: QueryStringContext): void => {\n  const script = document.createElement(\"script\");\n  script.type = \"text/javascript\";\n  script.innerHTML = `(function(w,d,t,r,u){var f,n,i;w[u]=w[u]||[],f=function(){var o={ti:${context.tagId}};o.q=w[u],w[u]=new UET(o),w[u].push(\"pageLoad\")},n=d.createElement(t),n.src=r,n.async=1,n.onload=n.onreadystatechange=function(){var s=this.readyState;s&&s!==\"loaded\"&&s!==\"complete\"||(f(),n.onload=n.onreadystatechange=null)},i=d.getElementsByTagName(t)[0],i.parentNode.insertBefore(n,i)})(window,document,\"script\",\"//bat.bing.com/bat.js\",\"uetq\");`;\n  document.head.appendChild(script);\n\n  window.uetq = window.uetq || [];\n};\n\n/**\n * This extension will send Bing Ads conversion events when a transaction is tracked\n */\n\nconst withSnowplowBingAdsExtension = (snowplow: SnowplowTracker) => {\n  setupExtension(snowplow.context);\n\n  // Original trackTransaction method\n  const trackTransaction = snowplow.ecommerce.trackTransaction;\n\n  //* Override the trackTransaction method\n  snowplow.ecommerce.trackTransaction = (input) => {\n    trackTransaction(input);\n\n    logger.info(` Bing Ads Extension Transaction Event`, {\n      transaction_id: input.id,\n      ecomm_prodid: input.items.map((item) => item.sku),\n      ecomm_pagetype: \"purchase\",\n      ecomm_totalvalue: input.total,\n      revenue_value: input.total,\n      currency: \"USD\",\n      items: input.items.map((item) => ({\n        id: item.sku,\n        quantity: item.quantity,\n        price: item.unitPrice,\n      })),\n    });\n\n    window.uetq.push(\"event\", \"purchase\", {\n      transaction_id: input.id,\n      ecomm_prodid: input.items.map((item) => item.sku),\n      ecomm_pagetype: \"purchase\",\n      ecomm_totalvalue: input.total,\n      revenue_value: input.total,\n      currency: \"USD\",\n      items: input.items.map((item) => ({\n        id: item.sku,\n        quantity: item.quantity,\n        price: item.unitPrice,\n      })),\n    });\n  };\n  return snowplow;\n};\n\nexport default withSnowplowBingAdsExtension;\n","import { createLogger } from \"src/shared/logger\";\nimport { SnowplowTracker } from \"../types\";\n\ninterface TryParseJSONObjectResult {\n  type: \"object\" | \"array\" | \"string\";\n  value: object | string;\n}\n// add a check to check if the jsonString is an array\nfunction tryParseJSONObject(jsonString: string): TryParseJSONObjectResult {\n  try {\n    var o: object = JSON.parse(jsonString);\n    if (o && typeof o === \"object\") {\n      return { type: \"object\", value: o };\n    }\n    if (Array.isArray(o)) {\n      return { type: \"array\", value: o };\n    }\n\n    return { type: \"string\", value: jsonString };\n  } catch (e) {\n    return { type: \"string\", value: jsonString };\n  }\n}\n\nconst withDeduplicationExtension = (snowplow: SnowplowTracker) => {\n  const logger = createLogger(\"MJ:Deduplication\");\n  const {\n    trackTransaction: originalTrackTransaction,\n    trackAddToCart: originalTrackAddToCart,\n    trackRemoveFromCart: originalTrackRemoveFromCart,\n  } = snowplow.ecommerce;\n\n  const { trackSignup: originalTrackSignup } = snowplow;\n\n  const getStorageKey = (eventType: string) => `${snowplow.context.appId}_${eventType}`;\n\n  const deduplicateEvent = <T>(\n    originalMethod: (input: T) => void,\n    eventType: string,\n    input: T,\n    idField: (keyof T)[],\n  ) => {\n    const storageKey = getStorageKey(eventType);\n    const eventId = idField.map((key) => input[key]).join(\":\");\n    let value: string | null = localStorage.getItem(storageKey);\n    let existingIds: string[] = [];\n\n    if (value) {\n      const parsed = tryParseJSONObject(value);\n      if (parsed?.type === \"object\") {\n        existingIds = parsed.value as string[];\n      } else if (parsed?.type === \"string\") {\n        existingIds = [parsed.value as string];\n      }\n    }\n\n    console.log(\"existingIds\", existingIds);\n    if (existingIds.includes(eventId)) {\n      logger.warn(`${eventType} with id ${eventId} already tracked. Discarding duplicate.`);\n      return;\n    }\n\n    originalMethod(input);\n    localStorage.setItem(storageKey, JSON.stringify([...existingIds, eventId]));\n  };\n\n  snowplow.ecommerce.trackTransaction = (input) =>\n    deduplicateEvent(originalTrackTransaction, \"transaction\", input, [\"id\"]);\n\n  snowplow.ecommerce.trackAddToCart = (input) =>\n    deduplicateEvent(originalTrackAddToCart, \"addToCart\", input, [\"name\", \"quantity\"]);\n\n  snowplow.ecommerce.trackRemoveFromCart = (input) =>\n    deduplicateEvent(originalTrackRemoveFromCart, \"removeFromCart\", input, [\"name\", \"quantity\"]);\n\n  snowplow.trackSignup = (input) => deduplicateEvent(originalTrackSignup, \"signUp\", input, [\"uuid\", \"emailAddress\"]);\n\n  return snowplow;\n};\n\nexport default withDeduplicationExtension;\n","import { SnowplowTracker } from \"src/shared/snowplow/types\";\n\n/**\n *\n * This extension ensures that the orderId for the basket items is the same as the orderId for the transaction.\n * This is important for Shopify integrations since the orderId for the basket items is the product id and not the order id.\n */\nconst withEnsureBasketItemsOrderId = (snowplow: SnowplowTracker) => {\n  const trackTransaction = snowplow.ecommerce.trackTransaction;\n\n  snowplow.ecommerce.trackTransaction = (input) => {\n    trackTransaction({\n      id: input.id,\n      affiliateId: input.affiliateId,\n      total: input.total,\n      tax: input.tax,\n      shipping: input.shipping,\n      city: input.city,\n      state: input.state,\n      country: input.country,\n      currency: input.currency,\n      discount: input.discount,\n      couponCode: input.couponCode,\n      alternativeTransactionIds: input.alternativeTransactionIds,\n      items: input.items.map((item) => ({\n        orderId: input.id,\n        sku: item.sku,\n        name: item.name,\n        category: item.category,\n        unitPrice: item.unitPrice,\n        quantity: item.quantity,\n        currency: item.currency,\n      })),\n    });\n  };\n\n  return snowplow;\n};\n\nexport default withEnsureBasketItemsOrderId;\n","import { SnowplowTracker } from \"src/shared/snowplow/types\";\nimport { RegisterThirdPartyTagsInput } from \"src/shared/types\";\n\nlet thirdPartyTags: RegisterThirdPartyTagsInput = {};\n\nconst registerThirdPartyTags = (input: RegisterThirdPartyTagsInput) => {\n  thirdPartyTags = input;\n};\n\nwindow.registerThirdPartyTags = registerThirdPartyTags;\n\nconst replaceMacros = (tag: string, placeholders: Record<string, string>) =>\n  tag.replace(/{\\w+}/g, (match) => placeholders[match] || match);\n\nconst createElementForTag = (type: string, tagWithMacros: string) => {\n  if (type === \"script\") {\n    const script = document.createElement(\"script\");\n    script.src = tagWithMacros;\n    script.async = true;\n    document.body.appendChild(script);\n  } else if (type === \"image\") {\n    const img = new Image();\n    img.src = tagWithMacros;\n    document.body.appendChild(img);\n  }\n};\n\nconst processTags = (tags: Array<{ tag: string; type: string }>, placeholders: Record<string, string>) => {\n  tags?.forEach(({ tag, type }) => {\n    const tagWithMacros = replaceMacros(tag, placeholders);\n    createElementForTag(type, tagWithMacros);\n  });\n};\n\nconst withRegisterThirdPartyTagsExtension = (snowplow: SnowplowTracker) => {\n  const { trackTransaction, trackAddToCart, trackRemoveFromCart } = snowplow.ecommerce;\n  const { trackSignup } = snowplow;\n\n  snowplow.ecommerce.trackTransaction = (input) => {\n    trackTransaction(input);\n    processTags(thirdPartyTags.onTransaction, {\n      \"{transaction_id}\": input?.id?.toString() || \"null\",\n      \"{transaction_total}\": input?.total?.toString() || \"0\",\n      \"{transaction_tax}\": input?.tax?.toString() || \"0\",\n      \"{transaction_shipping}\": input?.shipping?.toString() || \"0\",\n      \"{transaction_city}\": input?.city || \"null\",\n      \"{transaction_state}\": input?.state || \"null\",\n      \"{transaction_country}\": input?.country || \"null\",\n      \"{transaction_currency}\": input?.currency || \"null\",\n      \"{transaction_userId}\": input?.userId?.toString() || \"null\",\n    });\n  };\n\n  snowplow.ecommerce.trackAddToCart = (input) => {\n    trackAddToCart(input);\n    processTags(thirdPartyTags.onAddToCart, {\n      \"{cart_id}\": input?.sku || \"null\",\n      \"{cart_name}\": input?.name || \"null\",\n      \"{cart_category}\": input?.category || \"null\",\n      \"{cart_unitPrice}\": input?.unitPrice?.toString() || \"0\",\n      \"{cart_quantity}\": input?.quantity?.toString() || \"0\",\n      \"{cart_currency}\": input?.currency || \"null\",\n      \"{cart_userId}\": input?.userId?.toString() || \"null\",\n    });\n  };\n\n  snowplow.ecommerce.trackRemoveFromCart = (input) => {\n    trackRemoveFromCart(input);\n    processTags(thirdPartyTags.onRemoveFromCart, {\n      \"{cart_id}\": input?.sku || \"null\",\n      \"{cart_name}\": input?.name || \"null\",\n      \"{cart_category}\": input?.category || \"null\",\n      \"{cart_unitPrice}\": input?.unitPrice?.toString() || \"0\",\n      \"{cart_quantity}\": input?.quantity?.toString() || \"0\",\n      \"{cart_currency}\": input?.currency || \"null\",\n      \"{cart_userId}\": input?.userId?.toString() || \"null\",\n    });\n  };\n\n  snowplow.trackSignup = (input) => {\n    trackSignup(input);\n    processTags(thirdPartyTags.onSignup, {\n      \"{signup_firstName}\": input?.firstName || \"null\",\n      \"{signup_lastName}\": input?.lastName || \"null\",\n      \"{signup_uuid}\": input?.uuid || \"null\",\n      \"{signup_email}\": input?.emailAddress || \"null\",\n      \"{signup_address}\": input?.address || \"null\",\n      \"{signup_city}\": input?.city || \"null\",\n      \"{signup_state}\": input?.state || \"null\",\n      \"{signup_phone}\": input?.phoneNumber || \"null\",\n      \"{signup_advertiser}\": input?.advertiser || \"null\",\n    });\n  };\n\n  return snowplow;\n};\n\nexport default withRegisterThirdPartyTagsExtension;\n","module.exports = (require(\"./helpers/browser/js-loader\")(require('./helpers/bundle-manifest').resolve(\"9DPLo\"))).then(() => parcelRequire('7rUq7'));","module.exports = (require(\"./helpers/browser/js-loader\")(require('./helpers/bundle-manifest').resolve(\"6x0lw\"))).then(() => parcelRequire('54bLn'));"],"names":["$parcel$export","e","n","v","s","Object","defineProperty","get","set","enumerable","configurable","parcelRequire","$parcel$global","globalThis","self","window","global","parcelRegister","register","module","exports","$41a6c7ecc8ff7cf9$export$2e2bcd8739ae039","$lwczO","$dfzZn","$7FWw7","$iN4ie","$9nXWu","$cmhQG","$bhLWo","context","_context_plugin","plugins","plugin","split","snowplow","default","tracker","applyExtensions","includes","Promise","resolve","then","withGoogleAdsExtension","withBingAdsExtension","trackTrans","ecommerce","trackTransaction","trackSignUp","trackSignup","addToCart","trackAddToCart","removeFromCart","trackRemoveFromCart","event","load","environment","warn","$71b2d7d1db8aa308$export$2e2bcd8739ae039","input","appId","collector","info","version","isLegacyTracker","createSnowplowV1Tracker","createSnowplowV2Tracker","initialize","record","$3c9a89d8c1dfcb00$export$3ad3a750c394cfe6","extensions","reduce","currentTracker","extension","$dee74d8dbb686cf7$export$2e2bcd8739ae039","$gDuU6","$dee74d8dbb686cf7$var$setupExtension","liquidm","segmentId","s1","nexxen","pageVisitorBeaconId","transactionBeaconId","dstillery","siteVisitorNC","purchaseNC","segments","cnnaSegments","emit","emitPurchase","bprice","total","cid","id","amount","orderId","$641eec616192426d$export$2e2bcd8739ae039","$kcTRk","$8MHlY","$brv19","$c72892d13a5cb6a6$export$2e2bcd8739ae039","a","b","document","createElement","type","async","src","Date","getTime","getElementsByTagName","parentNode","insertBefore","$a9484abfa4e647eb$export$2e2bcd8739ae039","$2FQv2","beacons","pix","head","appendChild","console","$7320f870626fdaba$export$2e2bcd8739ae039","url","pixel","width","height","style","position","left","$c0eda113f7e844bf$export$2e2bcd8739ae039","$e28752228a952a06$export$2e2bcd8739ae039","$e28752228a952a06$var$setupExtension","gtag","dataLayer","push","arguments","conversionId","conversionLabel","crossDomainSites","domains","map","site","trim","send_to","value","currency","transaction_id","$b7d4fe9e37bf4000$export$2e2bcd8739ae039","$b7d4fe9e37bf4000$var$setupExtension","script","innerHTML","tagId","uetq","ecomm_prodid","items","item","sku","ecomm_pagetype","ecomm_totalvalue","revenue_value","quantity","price","unitPrice","$2698e4ae6f73631d$export$2e2bcd8739ae039","logger","createLogger","originalTrackTransaction","originalTrackAddToCart","originalTrackRemoveFromCart","originalTrackSignup","getStorageKey","eventType","deduplicateEvent","originalMethod","idField","storageKey","eventId","key","join","localStorage","getItem","existingIds","parsed","$2698e4ae6f73631d$var$tryParseJSONObject","jsonString","o","JSON","parse","Array","isArray","log","setItem","stringify","$b18efba9eb457c03$export$2e2bcd8739ae039","affiliateId","tax","shipping","city","state","country","discount","couponCode","alternativeTransactionIds","name","category","$71e7d74cb31b3edc$export$2e2bcd8739ae039","$71e7d74cb31b3edc$var$thirdPartyTags","registerThirdPartyTags","$71e7d74cb31b3edc$var$replaceMacros","tag","placeholders","replace","match","$71e7d74cb31b3edc$var$createElementForTag","tagWithMacros","body","img","Image","$71e7d74cb31b3edc$var$processTags","tags","forEach","_input_id","_input_total","_input_tax","_input_shipping","_input_userId","onTransaction","toString","userId","_input_unitPrice","_input_quantity","onAddToCart","onRemoveFromCart","onSignup","firstName","lastName","uuid","emailAddress","address","phoneNumber","advertiser"],"version":3,"file":"adapters.6626997d.js.map"}