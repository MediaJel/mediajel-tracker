{"mappings":"A,I,E,A,C,E,C,E,A,C,A,a,O,W,W,A,a,O,K,K,A,a,O,O,O,A,a,O,O,O,C,C,E,iB,E,Q,A,E,Q,S,C,C,C,E,O,c,C,E,O,C,U,C,I,W,O,C,E,I,K,E,W,C,E,a,C,C,G,I,E,E,S,E,E,SCyEA,EApEwB,KACtB,AAAA,CAAA,EAAA,EAAA,eAAc,AAAd,EAAgB,AAAC,IAgCf,GAAI,AAAe,aAAf,EAAK,KAAK,CACZ,GAAI,CACF,IAAM,EAAc,EAAK,SAAS,CAC5B,EAAW,EAAK,SAAS,CAAC,KAAK,CAC/B,CAAA,eAAE,CAAc,CAAA,MAAE,CAAK,CAAA,IAAE,CAAG,CAAE,CAAG,EACvC,AAAA,CAAA,EAAA,EAAA,OAAS,AAAT,EAAW,MAAM,CAAC,CAChB,iBAAkB,CAChB,GAAI,EAAe,QAAQ,GAC3B,MAAO,WAAW,GAClB,IAAK,WAAW,GAChB,SAAU,EACV,KAAM,MACN,MAAO,MACP,QAAS,MACT,SAAU,MACV,MAAO,EAAS,GAAG,CAAC,AAAC,GACZ,CAAA,CACL,QAAS,EAAe,QAAQ,GAChC,IAAK,EAAK,OAAO,CAAC,QAAQ,GAC1B,KAAO,AAAA,CAAA,EAAK,SAAS,EAAI,KAAA,EAAO,QAAQ,GACxC,SAAW,AAAA,CAAA,EAAK,aAAa,EAAI,KAAA,EAAO,QAAQ,GAChD,UAAW,WAAW,EAAK,KAAK,EAAI,GACpC,SAAU,SAAS,EAAK,QAAQ,EAAI,GACpC,SAAU,KACZ,CAAA,EAEJ,CACF,EACF,CAAE,MAAO,EAAO,CAEhB,CAEJ,EACF,C","sources":["<anon>","src/shared/environment-data-sources/yotpo.ts"],"sourcesContent":["(function () {\n\nfunction $parcel$export(e, n, v, s) {\n  Object.defineProperty(e, n, {get: v, set: s, enumerable: true, configurable: true});\n}\n\n      var $parcel$global =\n        typeof globalThis !== 'undefined'\n          ? globalThis\n          : typeof self !== 'undefined'\n          ? self\n          : typeof window !== 'undefined'\n          ? window\n          : typeof global !== 'undefined'\n          ? global\n          : {};\n  var parcelRequire = $parcel$global[\"parcelRequire07df\"];\nvar parcelRegister = parcelRequire.register;\nparcelRegister(\"6z0SB\", function(module, exports) {\n\n$parcel$export(module.exports, \"default\", function () { return $0137328586173738$export$2e2bcd8739ae039; });\n\nvar $2hYdk = parcelRequire(\"2hYdk\");\n\nvar $3tZSl = parcelRequire(\"3tZSl\");\nconst $0137328586173738$var$yotpoDataSource = ()=>{\n    (0, $3tZSl.datalayerSource)((data)=>{\n        // do not  remove commented code\n        // if (data.event === \"addToCart\") {\n        //   const products = data.ecommerce.add.products;\n        //   const currency = data.ecommerce.currency;\n        //   const { brand, category, id, name, price, quantity } = products[0];\n        //   addToCartEvent({\n        //     sku: id.toString(),\n        //     name: (name || \"N/A\").toString(),\n        //     category: (category || \"N/A\").toString(),\n        //     unitPrice: parseFloat(price || 0),\n        //     quantity: parseInt(quantity || 1),\n        //     currency: (currency || \"USD\").toString(),\n        //   });\n        // }\n        // if (data.event === \"removeFromCart\") {\n        //   const products = data.ecommerce.remove.products;\n        //   const currency = data.ecommerce.currency;\n        //   const { brand, category, id, name, price, quantity } = products[0];\n        //   removeFromCartEvent({\n        //     sku: id.toString(),\n        //     name: (name || \"N/A\").toString(),\n        //     category: (category || \"N/A\").toString(),\n        //     unitPrice: parseFloat(price || 0),\n        //     quantity: parseInt(quantity || 1),\n        //     currency: (currency || \"USD\").toString(),\n        //   });\n        // }\n        if (data.event === \"purchase\") try {\n            const transaction = data.ecommerce;\n            const products = data.ecommerce.items;\n            const { transaction_id: transaction_id, value: value, tax: tax } = transaction;\n            (0, $2hYdk.default).notify({\n                transactionEvent: {\n                    id: transaction_id.toString(),\n                    total: parseFloat(value),\n                    tax: parseFloat(tax),\n                    shipping: 0,\n                    city: \"N/A\",\n                    state: \"N/A\",\n                    country: \"N/A\",\n                    currency: \"USD\",\n                    items: products.map((item)=>{\n                        return {\n                            orderId: transaction_id.toString(),\n                            sku: item.item_id.toString(),\n                            name: (item.item_name || \"N/A\").toString(),\n                            category: (item.item_category || \"N/A\").toString(),\n                            unitPrice: parseFloat(item.price || 0),\n                            quantity: parseInt(item.quantity || 1),\n                            currency: \"USD\"\n                        };\n                    })\n                }\n            });\n        } catch (error) {\n        // window.tracker('trackError', JSON.stringify(error), 'YOTPO');\n        }\n    });\n};\nvar $0137328586173738$export$2e2bcd8739ae039 = $0137328586173738$var$yotpoDataSource;\n\n});\n\n})();\n//# sourceMappingURL=yotpo.ffd487c1.js.map\n","import observable from \"src/shared/utils/create-events-observable\";\n\nimport { datalayerSource } from \"../sources/google-datalayer-source\";\nimport { TransactionCartItem } from \"../types\";\n\nconst yotpoDataSource = () => {\n  datalayerSource((data: any) => {\n    // do not  remove commented code\n    // if (data.event === \"addToCart\") {\n    //   const products = data.ecommerce.add.products;\n    //   const currency = data.ecommerce.currency;\n    //   const { brand, category, id, name, price, quantity } = products[0];\n\n    //   addToCartEvent({\n    //     sku: id.toString(),\n    //     name: (name || \"N/A\").toString(),\n    //     category: (category || \"N/A\").toString(),\n    //     unitPrice: parseFloat(price || 0),\n    //     quantity: parseInt(quantity || 1),\n    //     currency: (currency || \"USD\").toString(),\n    //   });\n    // }\n\n    // if (data.event === \"removeFromCart\") {\n    //   const products = data.ecommerce.remove.products;\n    //   const currency = data.ecommerce.currency;\n    //   const { brand, category, id, name, price, quantity } = products[0];\n\n    //   removeFromCartEvent({\n    //     sku: id.toString(),\n    //     name: (name || \"N/A\").toString(),\n    //     category: (category || \"N/A\").toString(),\n    //     unitPrice: parseFloat(price || 0),\n    //     quantity: parseInt(quantity || 1),\n    //     currency: (currency || \"USD\").toString(),\n    //   });\n    // }\n\n    if (data.event === \"purchase\") {\n      try {\n        const transaction = data.ecommerce;\n        const products = data.ecommerce.items;\n        const { transaction_id, value, tax } = transaction;\n        observable.notify({\n          transactionEvent: {\n            id: transaction_id.toString(),\n            total: parseFloat(value),\n            tax: parseFloat(tax),\n            shipping: 0,\n            city: \"N/A\",\n            state: \"N/A\",\n            country: \"N/A\",\n            currency: \"USD\",\n            items: products.map((item) => {\n              return {\n                orderId: transaction_id.toString(),\n                sku: item.item_id.toString(),\n                name: (item.item_name || \"N/A\").toString(),\n                category: (item.item_category || \"N/A\").toString(),\n                unitPrice: parseFloat(item.price || 0),\n                quantity: parseInt(item.quantity || 1),\n                currency: \"USD\",\n              } as TransactionCartItem;\n            }),\n          },\n        });\n      } catch (error) {\n        // window.tracker('trackError', JSON.stringify(error), 'YOTPO');\n      }\n    }\n  });\n};\n\nexport default yotpoDataSource;\n"],"names":["parcelRequire","parcelRegister","$parcel$global","globalThis","self","window","global","register","module","exports","Object","defineProperty","get","$0137328586173738$export$2e2bcd8739ae039","set","s","enumerable","configurable","$2hYdk","$3tZSl","datalayerSource","data","event","transaction","ecommerce","products","items","transaction_id","value","tax","default","notify","transactionEvent","id","toString","total","parseFloat","shipping","city","state","country","currency","map","item","orderId","sku","item_id","name","item_name","category","item_category","unitPrice","price","quantity","parseInt","error"],"version":3,"file":"yotpo.ffd487c1.js.map"}